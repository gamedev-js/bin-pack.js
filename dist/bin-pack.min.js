var binpack=function(){"use strict";var t={rotatedWidth(t){return t.rotated?t.height:t.width},rotatedHeight(t){return t.rotated?t.width:t.height}};var i=function(i,e,h,r,o,n){let f=0;let d=0;let u=0;let a=false;let l=i.length;for(let o=0;o<l;++o){let g=i[o];if(f+t.rotatedWidth(g)>e){f=0;d=d+u+r;u=0}if(d+t.rotatedHeight(g)>h){a=true}g.x=f;g.y=d;f=f+t.rotatedWidth(g)+r;if(t.rotatedHeight(g)>u){u=t.rotatedHeight(g)}if(n){n(o,l,g.id)}}if(a){return new Error("Pack failed.")}};function e(i,h,r,o){if(i.right!==null){var n=e(i.right,h,r,o);if(n){return n}return e(i.bottom,h,r,o)}let f=t.rotatedWidth(h);let d=t.rotatedHeight(h);let u=f+r;let a=d+r;if(f>i.width||d>i.height){if(o===false){return null}if(d>i.width||f>i.height){return null}h.rotated=!h.rotated;f=t.rotatedWidth(h);d=t.rotatedHeight(h);u=f+r;a=d+r}i.right={x:i.x+u,y:i.y,width:i.width-u,height:d,right:null,bottom:null};i.bottom={x:i.x,y:i.y+a,width:i.width,height:i.height-a,right:null,bottom:null};return{x:i.x,y:i.y}}var h=function(t,i,h,r,o,n){let f={x:0,y:0,width:i,height:h,right:null,bottom:null};let d=t.length;let u=false;for(let i=0;i<d;++i){let h=t[i];let a=e(f,h,r,o);if(a){h.x=a.x;h.y=a.y}else{u=true}if(n){n(i,d,h.id)}}if(u){return new Error("Pack failed.")}};function r(t){return{x:t.x,y:t.y,width:t.width,height:t.height}}function o(t,i){if(t.x<=i.x&&t.x+t.width>=i.x+i.width&&t.y<=i.y&&t.y+t.height>=i.y+i.height){return true}return false}function n(t,i,e,h,r){r.score1=Number.MAX_VALUE;r.score2=Number.MAX_VALUE;let o={x:0,y:0,width:1,height:1};let n=false;for(let f=0;f<t.length;++f){let d=t[f];let u,a,l,g;if(d.width>=i&&d.height>=e){u=Math.abs(Math.floor(d.width)-i);a=Math.abs(Math.floor(d.height)-e);l=Math.min(u,a);g=Math.max(u,a);if(l<r.score1||l===r.score1&&g<r.score2){o.x=d.x;o.y=d.y;o.width=i;o.height=e;r.score1=l;r.score2=g;n=true}}if(h&&d.width>=e&&d.height>=i){u=Math.abs(Math.floor(d.width)-e);a=Math.abs(Math.floor(d.height)-i);l=Math.min(u,a);g=Math.max(u,a);if(l<r.score1||l===r.score1&&g<r.score2){o.x=d.x;o.y=d.y;o.width=e;o.height=i;r.score1=l;r.score2=g;n=true}}}if(n===false){r.score1=Number.MAX_VALUE;r.score2=Number.MAX_VALUE}return o}function f(t,i,e){if(e.x>=i.x+i.width||e.x+e.width<=i.x||e.y>=i.y+i.height||e.y+e.height<=i.y){return false}if(e.x<i.x+i.width&&e.x+e.width>i.x){if(e.y>i.y&&e.y<i.y+i.height){let h=r(i);h.height=e.y-h.y;t.push(h)}if(e.y+e.height<i.y+i.height){let h=r(i);h.y=e.y+e.height;h.height=i.y+i.height-(e.y+e.height);t.push(h)}}if(e.y<i.y+i.height&&e.y+e.height>i.y){if(e.x>i.x&&e.x<i.x+i.width){let h=r(i);h.width=e.x-h.x;t.push(h)}if(e.x+e.width<i.x+i.width){let h=r(i);h.x=e.x+e.width;h.width=i.x+i.width-(e.x+e.width);t.push(h)}}return true}function d(t,i){let e=t.length;for(let h=0;h<e;++h){if(f(t,t[h],i)){t.splice(h,1);--h;--e}}u(t)}function u(t){for(let i=0;i<t.length;++i){for(let e=i+1;e<t.length;++e){if(o(t[e],t[i])){t.splice(i,1);--i;break}if(o(t[i],t[e])){t.splice(e,1);--e}}}}var a=function(t,i,e,h,r,o){let f=[];f.push({x:0,y:0,width:i+h,height:e+h});let u=t.slice();let a={score1:Number.MAX_VALUE,score2:Number.MAX_VALUE};let l=0;let g=t.length;while(u.length>0){let t=Number.MAX_VALUE;let i=Number.MAX_VALUE;let e=-1;let c={x:0,y:0,width:1,height:1};for(let o=0;o<u.length;++o){let d=n(f,u[o].width+h,u[o].height+h,r,a);if(a.score1<t||a.score1===t&&a.score2<i){t=a.score1;i=a.score2;c=d;e=o}}if(e===-1){return new Error("Pack failed.")}d(f,c);let s=u.splice(e,1)[0];s.x=Math.floor(c.x);s.y=Math.floor(c.y);s.rotated=s.width+h!==c.width;if(o){o(l,g,s.id)}++l}};function l(t,i){let e=t.width-i.width;if(e===0){e=t.id.localeCompare(i.id)}return e}function g(t,i){let e=t.height-i.height;if(e===0){e=t.id.localeCompare(i.id)}return e}function c(t,i){let e=t.width*t.height-i.width*i.height;if(e===0){e=t.id.localeCompare(i.id)}return e}function s(t,i){return t.id.localeCompare(i.id)}function w(t,i){let e=t.width;if(t.height>t.width){e=t.height;t.rotated=true}let h=i.width;if(i.height>i.width){h=i.height;i.rotated=true}let r=e-h;if(r===0){r=t.id.localeCompare(i.id)}return r}function x(t,i){let e=t.height;if(t.width>t.height){e=t.width;t.rotated=true}let h=i.height;if(i.width>i.height){h=i.width;i.rotated=true}let r=e-h;if(r===0){r=t.id.localeCompare(i.id)}return r}function y(t,e,r,o,n,f,d){let u=null;if(e==="simple"){u=i}else if(e==="tree"){u=h}else if(e==="max-rect"){u=a}return u(t,r,o,n,f,d)}var m={sort(t,i="area",e="ascending",h=true){for(let i=0;i<t.length;++i){t[i].rotated=false}if(i==="width"){t.sort(h?w:l)}else if(i==="height"){t.sort(h?x:g)}else if(i==="area"){t.sort(c)}else{t.sort(s)}if(e==="descending"){t.reverse()}return t},pack(t,i,e,h,r=2,o=true,n=null){return y(t,i,e,h,r,o,n)},packAutoResize(t,i,e=32,h=32,r=2,o=true,n=null){let f=e;let d=h;while(1){let e=y(t,i,f,d,r,o,n);if(!e){return t}if(f===4096&&d===4096){console.error(e);return t}if(f===d){f*=2}else{d=f}}}};return m}();
//# sourceMappingURL=./dist/bin-pack.min.js.map